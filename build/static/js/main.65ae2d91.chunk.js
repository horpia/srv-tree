(this["webpackJsonpservers-infrastructure-tree"]=this["webpackJsonpservers-infrastructure-tree"]||[]).push([[0],[,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(1),i=n.n(a),s=n(10),r=n.n(s),o=n(2),l=n(7),d=n.n(l),u=n(9),j=n(3),m=n(4),h=n(6),b=n(5),v=function(){function e(t){var n;Object(j.a)(this,e),this.name=void 0,this.desc=void 0,this.id=void 0,this.searchStringCache="",this.name=t.getAttribute("name")||"",this.desc=(null===(n=t.querySelector(":scope > desc"))||void 0===n?void 0:n.textContent)||"",this.id=(this instanceof e?this.constructor:void 0).name+":"+this.name+"@"+ ++e.sequence}return Object(m.a)(e,[{key:"toSearchString",value:function(){return""!==this.searchStringCache||(this.searchStringCache=this.name+" "+this.desc+" "+this.getTextToSearch(),this.searchStringCache=this.searchStringCache.toLowerCase().split(" ").filter((function(e,t,n){return t===n.indexOf(e)})).join(" ").replace(/\s+/g," ").trimEnd()),this.searchStringCache}},{key:"toString",value:function(){return this.id}}]),e}();v.sequence=0;var p,O=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var c;return Object(j.a)(this,n),(c=t.call(this,e)).type=void 0,c.domain=void 0,c.localDomain=void 0,c.port=void 0,c.type=e.getAttribute("type")||"service",c.domain=e.getAttribute("domain")||"",c.localDomain=e.getAttribute("local-domain")||"",c.port=parseInt(e.getAttribute("port")||"0",10),c}return Object(m.a)(n,[{key:"getTextToSearch",value:function(){return this.type+" "+this.domain+" "+this.localDomain+" "+this.port}}]),n}(v),f=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var c;return Object(j.a)(this,n),(c=t.call(this,e)).ip=void 0,c.domain=void 0,c.localDomain=void 0,c.services=void 0,c.ip=e.getAttribute("ip")||"N/D",c.domain=e.getAttribute("domain")||"",c.localDomain=e.getAttribute("local-domain")||"",c.services=[],e.querySelectorAll(":scope > service").forEach((function(e){c.services.push(new O(e))})),c}return Object(m.a)(n,[{key:"getTextToSearch",value:function(){return this.ip+" "+this.domain+" "+this.localDomain+" "+this.services.map((function(e){return e.toSearchString()})).join(" ")}}]),n}(v),x=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var c,a,i,s,r;return Object(j.a)(this,n),(r=t.call(this,e)).ip=void 0,r.domain=void 0,r.localDomain=void 0,r.cpu=void 0,r.ram=void 0,r.disk=void 0,r.os=void 0,r.vms=void 0,r.services=void 0,r.ip=e.getAttribute("ip")||"",r.domain=e.getAttribute("domain")||"",r.localDomain=e.getAttribute("local-domain")||"",r.vms=[],r.services=[],r.cpu=(null===(c=e.querySelector(":scope > cpu"))||void 0===c?void 0:c.textContent)||"",r.ram=(null===(a=e.querySelector(":scope > ram"))||void 0===a?void 0:a.textContent)||"",r.disk=(null===(i=e.querySelector(":scope > disk"))||void 0===i?void 0:i.textContent)||"",r.os=(null===(s=e.querySelector(":scope > os"))||void 0===s?void 0:s.textContent)||"",e.querySelectorAll(":scope > vm").forEach((function(e){r.vms.push(new f(e))})),e.querySelectorAll(":scope > service").forEach((function(e){r.services.push(new O(e))})),r}return Object(m.a)(n,[{key:"getTextToSearch",value:function(){return this.ip+" "+this.domain+" "+this.localDomain+" "+this.cpu+" "+this.os+" "+this.vms.map((function(e){return e.toSearchString()})).join(" ")+" "+this.services.map((function(e){return e.toSearchString()})).join(" ")}}]),n}(v),_=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var c;return Object(j.a)(this,n),(c=t.call(this,e)).servers=void 0,c.servers=[],e.querySelectorAll(":scope > srv").forEach((function(e){c.servers.push(new x(e))})),c}return Object(m.a)(n,[{key:"getTextToSearch",value:function(){return this.servers.map((function(e){return e.toSearchString()})).join(" ")}}]),n}(v),N=function(){function e(){Object(j.a)(this,e),this.data=void 0,this.dataCenters=[]}return Object(m.a)(e,[{key:"loadByUrl",value:function(){var e=Object(u.a)(d.a.mark((function e(t){var n,c,a,i,s,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{cache:"no-cache"});case 2:return e.next=4,e.sent.text();case 4:return c=e.sent,this.data=(new DOMParser).parseFromString(c,"application/xml"),(a=t.split("/")).pop(),i=a.join("/"),s=[],this.data.querySelectorAll("include[src]").forEach((function(e){s.push(new Promise(function(){var t=Object(u.a)(d.a.mark((function t(n){var c,a,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=i+"/"+e.getAttribute("src"),t.next=3,fetch(c,{cache:"no-cache"});case 3:return t.next=5,t.sent.text();case 5:a=t.sent,s=(new DOMParser).parseFromString(a,"application/xml"),e.parentElement&&s.firstElementChild&&e.parentElement.replaceChild(s.firstElementChild,e),n();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))})),e.next=13,Promise.all(s);case 13:return r=[],this.data.querySelectorAll("infra > dc").forEach((function(e){r.push(new _(e))})),(n=this.dataCenters).splice.apply(n,[0,this.dataCenters.length].concat(r)),e.abrupt("return",this);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();n(17),n(18),n(19),n(20),n(21);function S(e){return Object(c.jsxs)("div",{className:"connector connector_"+e.type,children:[Object(c.jsx)("div",{className:"connector__v-line"}),Object(c.jsxs)("div",{className:"connector__connection",children:[Object(c.jsx)("div",{className:"connector__point"}),Object(c.jsx)("div",{className:"connector__h-line",children:Object(c.jsx)("div",{className:"connector__caption",children:e.caption||""})}),e.domain?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"connector__wan-point"}),Object(c.jsx)("div",{className:"connector__wan-line",children:Object(c.jsx)("div",{className:"connector__wan-caption",children:g(e.domain)})})]}):null,e.localDomain?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"connector__lan-point"}),Object(c.jsx)("div",{className:"connector__lan-line",children:Object(c.jsx)("div",{className:"connector__lan-caption",children:g(e.localDomain)})})]}):null]})]})}function g(e){return e.split(",").map((function(e,t){return Object(c.jsx)("div",{children:e},t.toString())}))}!function(e){e.LAN="lan",e.WAN="wan",e.VM="vm",e.ROOT_SERVICE="root-service",e.SERVICE="service"}(p||(p={}));n(22);var C=n.p+"static/media/icons.ac4d105b.svg",E=n.p+"static/media/elasticsearch.81e26c95.svg",y=n.p+"static/media/apache.ec3db90d.svg",T=n.p+"static/media/mssql.cfe2c656.svg",A=n.p+"static/media/db2.5d89dc76.svg",w=(n(23),["server","vm","data-center","service","arrow","info","cancel","php","php-fpm","nginx","redis","mysql","cassandra","rabbitmq","sphinxsearch","elasticsearch","clickhouse","docker","nodejs","kafka","cron","crontab","storage","postgresql","mariadb","oracle","mongodb","apache","mssql","db2","jenkins","consul","kibana","zabbix","ansible","graylog","vault"]),k={elasticsearch:E,apache:y,mssql:T,db2:A};function R(e){var t=e.name.toLowerCase(),n=e.className||"";return w.includes(t)||(t="service"),"string"===typeof k[t]?Object(c.jsx)("img",{src:k[t],alt:"",className:"icon "+n}):Object(c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"icon "+n,children:Object(c.jsx)("use",{href:"".concat(C,"#").concat(t)})})}var D;n(24);function I(e){return Object(c.jsx)("div",{className:"arrow-button",hidden:!!e.hidden,children:Object(c.jsx)(R,{name:"arrow",className:(e.isOpen?"icon_rot270":"icon_rot90")+" icon_sm arrow-button__icon"})})}!function(e){e[e.NONE=0]="NONE",e[e.DATA_CENTER=1]="DATA_CENTER",e[e.SERVER=2]="SERVER",e[e.VIRTUAL_MACHINE=3]="VIRTUAL_MACHINE",e[e.SERVICE=4]="SERVICE"}(D||(D={}));var V={collapseTo:D.NONE,setCollapseTo:function(e){}},q=i.a.createContext(V);function M(e){var t=Object(a.useState)(D.NONE),n=Object(o.a)(t,2),i={collapseTo:n[0],setCollapseTo:n[1]};return Object(c.jsx)(q.Provider,{value:i,children:e.children})}function L(e){var t=Object(a.useContext)(q),n=Object(a.useState)(!1),i=Object(o.a)(n,2),s=i[0],r=i[1],l=["node-label"];s&&l.push("node-label_show-info"),e.isEmpty&&l.push("node-label_empty");return Object(c.jsxs)("div",{className:l.join(" "),children:[Object(c.jsx)("div",{className:"node-label__info",children:e.children}),Object(c.jsxs)("div",{className:"node-label__buttons-group",children:[Object(c.jsxs)("div",{className:"node-label__button",onClick:function(){e.setOpenState&&(t.collapseTo!==D.NONE&&t.setCollapseTo(D.NONE),e.setOpenState(!e.isOpen))},children:[Object(c.jsx)(R,{name:e.icon}),Object(c.jsx)(I,{isOpen:e.isOpen||!1,hidden:e.isEmpty}),Object(c.jsx)("div",{className:"node-label__name",children:e.name})]}),Object(c.jsx)("div",{className:"node-label__info-button",onClick:function(){return r(!s)},children:Object(c.jsx)(R,{name:"info"})})]})]})}n(25);function H(e){return Object(c.jsx)("div",{"data-search":e.searchText,className:"infra-tree-node "+e.className,children:e.children})}function U(e){var t=e.isRoot?p.ROOT_SERVICE:p.SERVICE;return Object(c.jsxs)(H,{searchText:e.model.toSearchString(),className:"service",children:[Object(c.jsx)(S,{type:t,caption:e.model.port>0?":"+e.model.port:"",domain:e.model.domain,localDomain:e.model.localDomain}),Object(c.jsx)("div",{className:"service__body",children:Object(c.jsx)(L,{icon:e.model.type,name:e.model.name||e.model.type,isEmpty:!0,children:e.model.desc})})]})}function P(e){var t=Object(a.useState)(!0),n=Object(o.a)(t,2),i=n[0],s=n[1],r=Object(a.useContext)(q);if(r.collapseTo===D.VIRTUAL_MACHINE&&i)return s(!1),null;if(r.collapseTo===D.SERVICE&&!i)return s(!0),null;var l=e.model.services.map((function(e){return Object(c.jsx)(U,{model:e},e.toString())})),d=0===l.length;return Object(c.jsxs)(H,{searchText:e.model.toSearchString(),className:"vm",children:[Object(c.jsx)(S,{type:p.VM,caption:e.model.ip,domain:e.model.domain,localDomain:e.model.localDomain}),Object(c.jsxs)("div",{className:"vm__body",children:[Object(c.jsx)(L,{icon:"vm",name:e.model.name,isEmpty:d,isOpen:i,setOpenState:s,children:e.model.desc}),Object(c.jsx)("div",{className:"vm__services",hidden:!i,children:l})]})]})}n(26);function F(e){return Object(c.jsx)("div",{className:"properties-group",children:e.children})}function B(e){return Object(c.jsxs)("div",{className:"property",children:[Object(c.jsxs)("span",{className:"property__caption",children:[e.caption,":"]}),Object(c.jsx)("span",{className:"property__value",children:e.value})]})}function W(e){var t=Object(a.useState)(!0),n=Object(o.a)(t,2),i=n[0],s=n[1],r=Object(a.useContext)(q);if(r.collapseTo===D.SERVER){if(i)return s(!1),null}else if([D.VIRTUAL_MACHINE,D.SERVICE].includes(r.collapseTo)&&!i)return s(!0),null;var l=e.model.vms.map((function(e){return Object(c.jsx)(P,{model:e},e.toString())})),d=e.model.services.map((function(e){return Object(c.jsx)(U,{isRoot:!0,model:e},e.toString())})),u=0===d.length&&0===l.length;return Object(c.jsxs)(H,{searchText:e.model.toSearchString(),className:"server",children:[Object(c.jsx)(S,{type:p.LAN,caption:e.model.ip,domain:e.model.domain,localDomain:e.model.localDomain}),Object(c.jsxs)("div",{className:"server__body",children:[Object(c.jsxs)(L,{icon:"server",name:e.model.name,isEmpty:u,isOpen:i,setOpenState:s,children:[Object(c.jsxs)(F,{children:[Object(c.jsx)(B,{caption:"CPU",value:e.model.cpu}),Object(c.jsx)(B,{caption:"RAM",value:e.model.ram}),Object(c.jsx)(B,{caption:"Disk",value:e.model.disk}),Object(c.jsx)(B,{caption:"OS",value:e.model.os})]}),Object(c.jsx)("div",{children:e.model.desc})]}),Object(c.jsxs)("div",{className:"server__content",hidden:!i,children:[d,l]})]})]})}function J(e){var t=Object(a.useState)(!0),n=Object(o.a)(t,2),i=n[0],s=n[1],r=Object(a.useContext)(q);if(r.collapseTo===D.DATA_CENTER){if(i)return s(!1),null}else if(r.collapseTo!==D.NONE&&!i)return s(!0),null;var l=0,d=e.model.servers.map((function(e){return l+=e.vms.length,Object(c.jsx)(W,{model:e},e.toString())})),u=0===d.length;return Object(c.jsxs)(H,{searchText:e.model.toSearchString(),className:"data-center",children:[Object(c.jsx)(S,{type:p.WAN}),Object(c.jsx)("div",{className:"data-center__wan-label",children:"WAN"}),Object(c.jsxs)("div",{className:"data-center__body",children:[Object(c.jsxs)(L,{icon:"data-center",name:e.model.name,isEmpty:u,isOpen:i,setOpenState:s,children:[Object(c.jsxs)(F,{children:[Object(c.jsx)(B,{caption:"Servers",value:d.length}),Object(c.jsx)(B,{caption:"VMs",value:l})]}),Object(c.jsx)("div",{children:e.model.desc})]}),Object(c.jsxs)("div",{className:"data-center__servers",hidden:!i,children:[Object(c.jsx)("div",{className:"data-center__lan-label",children:"LAN"}),d]})]})]})}n(27);function z(e){var t=Object(a.useState)([]),n=Object(o.a)(t,2),i=n[0],s=n[1];Object(a.useEffect)((function(){(new N).loadByUrl("data/data.xml").then((function(e){s(e.dataCenters)}))}),[]);var r=i.map((function(e){return Object(c.jsx)(J,{model:e},e.toString())}));return Object(c.jsxs)("div",{className:"infra-tree",children:[Object(c.jsxs)("div",{className:"infra-tree__search-stat",hidden:0===e.hiddenNodesCount,children:["Hidden nodes: ",e.hiddenNodesCount]}),Object(c.jsx)("div",{className:"infra-tree__data-centers",children:r})]})}n(28),n(29);function K(e){var t,n=Object(a.useContext)(q);return Object(c.jsxs)("div",{className:"filter-bar",children:[Object(c.jsx)("label",{className:"filter-bar__caption",htmlFor:"search-input",children:"Search: "}),Object(c.jsx)("input",{ref:function(e){return t=e},className:"filter-bar__search",id:"search-input",type:"text",autoComplete:"off",onKeyUp:function(n){return e.setHiddenNodesCount(X(t.value))},placeholder:"Name, ip, port etc..."}),Object(c.jsx)("div",{className:"filter-bar__button filter-bar__button_cancel",onClick:function(){return e.setHiddenNodesCount(X(t.value=""))},children:Object(c.jsx)(R,{name:"cancel"})}),Object(c.jsx)("label",{className:"filter-bar__caption",children:"Collapse to: "}),Object(c.jsx)("div",{className:"filter-bar__button filter-bar__button_dc",onClick:function(){n.setCollapseTo(D.DATA_CENTER)},children:Object(c.jsx)(R,{name:"data-center"})}),Object(c.jsx)("div",{className:"filter-bar__button filter-bar__button_srv",onClick:function(){n.setCollapseTo(D.SERVER)},children:Object(c.jsx)(R,{name:"server"})}),Object(c.jsx)("div",{className:"filter-bar__button filter-bar__button_vm",onClick:function(){n.setCollapseTo(D.VIRTUAL_MACHINE)},children:Object(c.jsx)(R,{name:"vm"})}),Object(c.jsx)("div",{className:"filter-bar__button filter-bar__button_service",onClick:function(){n.setCollapseTo(D.SERVICE)},children:Object(c.jsx)(R,{name:"service"})})]})}function X(e){e=e.replace(/["'[\]]/g,"").toLowerCase();var t=document.querySelectorAll(".infra-tree-node");if(""===e)return t.forEach((function(e){e.hidden=!1})),0;var n=0;return t.forEach((function(t){var c=t,a=c.dataset.search;c.hidden=!a.includes(e),c.hidden&&n++})),n}function G(){var e=Object(a.useState)(0),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(c.jsxs)(M,{children:[Object(c.jsx)(K,{setHiddenNodesCount:i}),Object(c.jsx)(z,{hiddenNodesCount:n})]})}r.a.render(Object(c.jsx)(a.StrictMode,{children:Object(c.jsx)(G,{})}),document.getElementById("root"))}],[[30,1,2]]]);
//# sourceMappingURL=main.65ae2d91.chunk.js.map